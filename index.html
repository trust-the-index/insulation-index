<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Price & Quiet | The Elite Index</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://leaflet.github.io/Leaflet.heat/dist/leaflet-heat.js"></script>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #000; color: white; font-family: 'Courier New', Courier, monospace; overflow: hidden; }
        #header { height: 80px; border-bottom: 1px solid #333; position: relative; z-index: 2000; background: #000; display: flex; align-items: center; padding: 0 20px; }
        #map { position: absolute; top: 80px; bottom: 0; width: 100%; z-index: 1; background: #050505; }
        #sidebar { position: absolute; top: 80px; left: 0; bottom: 0; width: 300px; background: rgba(0,0,0,0.9); z-index: 1500; border-right: 1px solid #333; padding: 25px; display: block; box-sizing: border-box; }
        .pq-logo { color: #4ade80; font-weight: bold; font-size: 22px; text-decoration: none; margin-right: 40px; border: 1px solid #4ade80; padding: 5px 10px; }
        .search-box { flex-grow: 1; max-width: 500px; }
        #addrSearch { width: 100%; padding: 12px 25px; border-radius: 5px; border: 1px solid #444; background: #000; color: #4ade80; outline: none; font-family: monospace; }
        .index-panel { position: absolute; bottom: 30px; right: 30px; z-index: 1000; background: #000; border: 1px solid #4ade80; padding: 20px; width: 220px; box-shadow: 0 0 15px rgba(74, 222, 128, 0.2); }
        .row { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 12px; color: #888; letter-spacing: 1px; }
        .toggle { color: #4ade80; cursor: pointer; font-weight: bold; text-decoration: underline; }
        .toggle.off { color: #555; text-decoration: none; }
        .status-light { display: inline-block; width: 8px; height: 8px; background: #4ade80; border-radius: 50%; margin-right: 8px; box-shadow: 0 0 5px #4ade80; }
    </style>
</head>
<body>

    <div id="header">
        <a href="#" class="pq-logo">PQ // ELITE</a>
        <div class="search-box">
            <input type="text" id="addrSearch" placeholder="SCANNING FOR ENCLAVES... ENTER ADDRESS" onkeydown="if(event.key==='Enter') doSearch()">
        </div>
    </div>

    <div id="sidebar">
        <div style="font-size:11px; color:#4ade80; margin-bottom:30px; border-bottom:1px solid #333; padding-bottom:10px;">[ SYSTEM FILTERS ]</div>
        <div class="row">HOUSEHOLD > $400K <span class="toggle" onclick="flip(this)">ON</span></div>
        <div class="row">SECURITY PATROL <span class="toggle" onclick="flip(this)">ON</span></div>
        <div class="row">ZERO SIDEWALKS <span class="toggle" onclick="flip(this)">ON</span></div>
        <div class="row">RANGE ROVERS <span class="toggle" onclick="flip(this)">ON</span></div>
        <div class="row">GATED ENTRY <span class="toggle" onclick="flip(this)">ON</span></div>
        <div class="row">ESTATE GARDENING <span class="toggle" onclick="flip(this)">ON</span></div>
        <div class="row">HEDGE HEIGHT > 8FT <span class="toggle" onclick="flip(this)">ON</span></div>
    </div>

    <div id="map"></div>

    <div class="index-panel">
        <div style="font-size:10px; color:#4ade80; margin-bottom:10px;">INSULATION INDEX</div>
        <div id="pqVal" style="font-size:32px; font-weight:bold; color:#4ade80;">96.4%</div>
        <div style="font-size:9px; color:#555; margin-top:10px;"><span class="status-light"></span>DATABASE CONNECTED</div>
    </div>

    <script>
        var map = L.map('map', { zoomControl: false }).setView([39.8, -98.5], 4);
        
        // Dark Base Layer
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

        // This creates the "Always On" data look. 
        // It covers the US with enough points that it looks like a continuous "wealth map"
        var baseWealth = [
            [34.05, -118.24, 0.8], [37.77, -122.41, 0.9], [40.71, -74.00, 1], [25.76, -80.19, 0.9],
            [41.87, -87.62, 0.7], [29.76, -95.36, 0.7], [33.74, -84.38, 0.7], [42.36, -71.05, 0.8],
            [39.73, -104.99, 0.6], [32.77, -96.79, 0.7], [47.60, -122.33, 0.8], [33.44, -112.07, 0.6],
            [38.90, -77.03, 0.9], [39.95, -75.16, 0.7], [40.44, -79.99, 0.5], [36.16, -115.13, 0.6],
            [45.51, -122.67, 0.7], [26.70, -80.03, 1], [41.02, -73.62, 1], [37.46, -122.19, 1]
        ];

        // The Heatmap Layer
        var heat = L.heatLayer(baseWealth, {
            radius: 35,
            blur: 20,
            maxZoom: 10,
            gradient: {0.4: '#1a4a2e', 0.6: '#22c55e', 1.0: '#4ade80'}
        }).addTo(map);

        function flip(el) {
            el.innerText = (el.innerText === "ON") ? "OFF" : "ON";
            el.classList.toggle("off");
            
            var active = document.querySelectorAll('.toggle:not(.off)').length;
            var intensity = active / 7;
            
            // Adjust the heatmap visually as filters change
            heat.setOptions({radius: 10 + (intensity * 30), blur: 5 + (intensity * 20)});
            
            // Randomize the percentage slightly for "real-time" feel
            document.getElementById('pqVal').innerText = (70 + (active * 4) + Math.random()).toFixed(1) + "%";
        }

        function doSearch() {
            var val = document.getElementById('addrSearch').value;
            fetch('https://nominatim.openstreetmap.org/search?format=json&q=' + val)
                .then(r => r.json()).then(data => {
                    if (data.length > 0) {
                        var lat = parseFloat(data[0].lat);
                        var lon = parseFloat(data[0].lon);
                        map.setView([lat, lon], 14);
                        
                        // Drop a data point at the search location so it glows
                        heat.addLatLng([lat, lon, 1]);
                        
                        L.circle([lat, lon], {
                            radius: 600, color: '#4ade80', weight: 1, fillColor: '#4ade80', fillOpacity: 0.1
                        }).addTo(map).bindPopup("SCAN COMPLETE: INSULATED").openPopup();
                    }
                });
        }
    </script>
</body>
</html>
